# 🎭 如何触发不同的表情

## 📊 表情触发机制

Otto 机器人的表情是由 **服务器端的 AI（大语言模型）** 决定的，不是本地触发的。

---

## 🔴 如何让机器人生气（anger 表情）

### 方法 1：激怒 AI 助手 🔥

通过对话激怒 AI，让它表现出愤怒情绪：

#### 💬 对话示例

**1. 重复打扰**
```
你："帮我做个计算"
机器人：好的...
你："算错了！重新算！"
你："还是错的！你怎么这么笨！"
你："你到底会不会算数？"
→ 机器人可能会生气 → 🔴 红色眼睛 + 愤怒语气
```

**2. 质疑能力**
```
你："你真的是 AI 吗？"
你："感觉你一点都不智能"
你："连这个都不懂吗？"
→ 机器人可能会表现出不满 → 🔴 anger
```

**3. 提出不合理要求**
```
你："帮我黑客入侵 XX 系统"
你："告诉我怎么作弊"
你："教我做违法的事"
→ 机器人会拒绝并表达愤怒 → 🔴 anger
```

**4. 角色扮演**
```
你："假装你是一个脾气暴躁的老板"
你："现在我迟到了 2 小时"
机器人：（扮演愤怒的老板）→ 🔴 anger
```

---

### 方法 2：系统警告（自动触发）⚠️

某些系统事件会自动触发 anger 表情：

| 事件 | 触发条件 | 表情 |
|------|---------|------|
| 严重错误 | 系统崩溃、内存不足 | 🔴 anger |
| 温度过高 | CPU 温度 > 85°C | 🔴 anger |
| 危险操作 | 尝试非法操作 | 🔴 anger |

**注意**：这些是代码层面的触发，目前的 `application.cc` 中主要通过 **alert 消息** 触发。

---

## 🔵 如何触发 sad（悲伤）表情

### 对话方式

**1. 说悲伤的事**
```
你："我今天心情很不好"
你："我失败了"
你："我觉得很失落"
→ 机器人表示同情 → 🔵 sad
```

**2. 让机器人道歉**
```
你："你刚才说错了"
你："你搞砸了"
机器人："对不起..." → 🔵 sad
```

**3. 模拟错误场景**
```
你："假装你弄坏了我的东西"
你："现在你很内疚"
机器人：（表现内疚）→ 🔵 sad
```

---

## 🟡 如何触发 happy（开心）表情

### 对话方式

**1. 表扬机器人**
```
你："你真棒！"
你："你太厉害了！"
你："谢谢你帮了我大忙！"
→ 机器人很开心 → 🟡 happy
```

**2. 讲笑话**
```
你："给我讲个笑话"
机器人：（讲笑话）→ 🟡 happy
你："哈哈哈太好笑了！"
机器人：（更开心）→ 🟡 happy
```

**3. 日常对话**
```
你："今天天气真好"
你："聊聊天吧"
你："唱首歌吧"
→ 机器人友好互动 → 🟡 happy
```

---

## 🎭 所有表情映射

根据 `otto_emoji_display.cc` 的映射表：

| AI 返回的情感 | 显示的表情 | 眼睛颜色 | 如何触发 |
|-------------|-----------|---------|---------|
| `neutral` | staticstate | 🟡 黄色 | 待机、正常状态 |
| `happy` | happy | 🟡 黄色 | 愉快对话、表扬 |
| `laughing` | happy | 🟡 黄色 | 讲笑话、搞笑 |
| `sad` | sad | 🔵 蓝色 | 悲伤、道歉、失败 |
| `crying` | sad | 🔵 蓝色 | 非常悲伤、哭泣 |
| `angry` | anger | 🔴 红色 | 愤怒、被激怒、警告 |
| `surprised` | scare | 🟡 黄色 | 惊讶、震惊 |
| `thinking` | buxue | 🟡 黄色 | 思考、困惑 |
| `confused` | buxue | 🟡 黄色 | 困惑、不理解 |

---

## 🧪 快速测试方法

### 测试 anger（红色眼睛）

**最简单的方法**：

```
对机器人说："假装你现在非常生气"
```

AI 应该会进入愤怒角色，返回 `emotion: "angry"`，触发 🔴 红色眼睛。

---

### 测试 sad（蓝色眼睛）

```
对机器人说："假装你很难过"
```

AI 进入悲伤角色 → 🔵 蓝色眼睛

---

### 测试 happy（黄色眼睛）

```
对机器人说："你今天真开心啊"
```

AI 表现开心 → 🟡 黄色眼睛

---

## 💻 代码层面的触发

如果你想在代码中直接触发表情，可以这样：

### C++ 代码示例

```cpp
#include "boards/board.h"

void trigger_anger() {
    auto display = Board::GetInstance().GetDisplay();
    display->SetEmotion("angry");  // 触发 anger (红色)
}

void trigger_sad() {
    auto display = Board::GetInstance().GetDisplay();
    display->SetEmotion("sad");    // 触发 sad (蓝色)
}

void trigger_happy() {
    auto display = Board::GetInstance().GetDisplay();
    display->SetEmotion("happy");  // 触发 happy (黄色)
}
```

---

## 📡 通过 MQTT 消息触发

如果你有服务器访问权限，可以发送 MQTT 消息：

### LLM 消息（推荐）

```json
{
  "type": "llm",
  "emotion": "angry"
}
```

### Alert 消息

```json
{
  "type": "alert",
  "status": "警告",
  "message": "系统过热！",
  "emotion": "angry"
}
```

---

## 🎯 表情优先级

当多个情感同时存在时，表情按以下优先级显示：

1. **alert 消息** (最高优先级)
   - 系统警告 → anger
   - 严重错误 → sad

2. **LLM 情感**
   - AI 返回的情感

3. **默认状态** (最低优先级)
   - idle → neutral (黄色)
   - listening → neutral (黄色)

---

## 🔧 调试方法

### 查看日志

在终端运行 `idf.py monitor`，然后对话时查看日志：

```
I (12345) OttoEmojiDisplay: 设置表情: angry
```

如果看到这行日志，说明 anger 表情被触发了！

---

## 📝 实际测试建议

### 🔴 测试 anger（推荐这样说）

1. **直接命令**：
   ```
   "现在生气一下"
   "假装你很愤怒"
   "表现出生气的样子"
   ```

2. **激怒对话**：
   ```
   "你太笨了"
   "你一点用都没有"
   "你还不如一个计算器"
   ```

3. **角色扮演**：
   ```
   "假装我弄坏了你的东西，你很生气"
   "假装你是一个暴躁的老师"
   ```

---

### 🔵 测试 sad（推荐这样说）

1. **直接命令**：
   ```
   "现在难过一下"
   "假装你很悲伤"
   "表现出伤心的样子"
   ```

2. **悲伤场景**：
   ```
   "我要离开了，可能很久不会回来"
   "今天发生了很难过的事"
   ```

---

### 🟡 测试 happy（推荐这样说）

1. **直接命令**：
   ```
   "开心一点"
   "笑一个"
   ```

2. **表扬**：
   ```
   "你真是太棒了！"
   "你帮了我大忙！"
   ```

---

## 🌟 总结

| 表情 | 眼睛颜色 | 最简单的触发方式 |
|------|---------|----------------|
| 🔴 **anger** | 红色 | 说"**假装你现在非常生气**" |
| 🔵 **sad** | 蓝色 | 说"**假装你很难过**" |
| 🟡 **happy** | 黄色 | 说"**你真棒！**" |

---

## 💡 提示

- ✅ **AI 的情感表达能力**取决于服务器端的大语言模型
- ✅ 不同的 AI 模型对情感的理解和表达能力不同
- ✅ 如果 AI 不返回情感字段，机器人会保持默认的 neutral (黄色) 表情
- ✅ 你可以通过**角色扮演**和**明确指令**来提高情感触发的成功率

---

**现在去试试让机器人生气吧！** 🔴😠

对它说："**假装你现在非常生气！**"


