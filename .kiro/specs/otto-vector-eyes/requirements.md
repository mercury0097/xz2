# Otto 矢量眼睛系统移植需求

## 概述
将 esp32-eyes 开源库移植到 Otto 机器人项目，替换现有的 GIF 表情系统，实现矢量绘制的动态眼睛表情。保留原有 GIF 系统作为备选方案。

## 背景
- 当前系统使用预制 GIF 动画显示表情，占用存储空间大，表情种类有限
- esp32-eyes 是基于参数的矢量眼睛系统，支持 18 种表情预设，可实时控制眼睛形状、位置、眨眼等
- 原库基于 Arduino + U8G2，需要移植到 ESP-IDF + LVGL

## 功能需求

### FR-1: 矢量眼睛渲染引擎
移植 esp32-eyes 的核心绘制逻辑到 LVGL，支持：
- 基于参数的眼睛形状绘制（宽度、高度、圆角、斜度等）
- 左右眼独立控制，支持镜像
- 实时更新渲染

### FR-2: 表情预设系统
支持 18 种内置表情预设：
- Normal, Happy, Glee, Sad, Worried, Focused, Annoyed, Surprised
- Skeptic, Frustrated, Unimpressed, Sleepy, Suspicious, Squint
- Angry, Furious, Scared, Awe

### FR-3: 表情过渡动画
- 表情之间平滑过渡（参数插值）
- 可配置过渡时间
- 支持缓动函数

### FR-4: 眨眼系统
- 自动随机眨眼
- 可触发手动眨眼
- 眨眼动画平滑

### FR-5: 视线控制
- 眼睛可以看向不同方向（左、右、上、下、中）
- 随机视线移动行为
- 平滑视线过渡

### FR-6: 兼容现有接口
- 保持 `SetEmotion(const char* emotion)` 接口不变
- 映射现有 21 种表情名称到新系统
- 保留聊天消息显示功能

### FR-7: GIF 备选方案
- 保留原有 GIF 表情代码和资源
- 支持通过配置切换 GIF/矢量模式
- 确保可以随时回退

## 非功能需求

### NFR-1: 性能
- 渲染帧率 >= 30 FPS
- CPU 占用合理，不影响语音处理

### NFR-2: 内存
- 矢量系统内存占用 < GIF 系统
- 无内存泄漏

### NFR-3: 可维护性
- 代码结构清晰，易于添加新表情
- 参数可调，便于微调表情效果

## 验收标准

- AC-1: 所有 18 种表情预设正确显示
- AC-2: 表情切换有平滑过渡动画
- AC-3: 眨眼和视线移动自然流畅
- AC-4: 现有 `SetEmotion` 调用无需修改
- AC-5: 可通过配置切换回 GIF 模式
- AC-6: 编译通过，无警告
- AC-7: 在 240x240 圆形屏幕上显示正常
