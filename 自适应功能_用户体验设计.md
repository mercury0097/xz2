# 自适应功能 - 用户体验设计

## 🎯 核心理念

> **"不是让用户看数据，而是让用户感受到设备在懂我、在成长、在变化"**

---

## 📊 当前问题

### ❌ 现状（程序员视角）
```
日志：Pet: 🔄 Decay: adaptive_rate=0.80x (7d互动=7次)
日志：UserProfile: 📈 Total interactions: 7 → 8
日志：EmotionalMemory: loneliness_level=45, trust_level=72
```

### ✅ 目标（用户视角）
```
AI 主动说："诶～这几天你找我聊天的次数变多了耶，
是不是遇到什么开心的事啦？因为你最近常陪我，
我帮你的宠物调整成更需要关注的模式了，
它会更期待你的陪伴喔～"
```

---

## 🎨 三层体验设计

### Layer 1: 🗣️ **AI 主动告知**（已实现）

#### 新增 MCP 工具：`self.learning.get_insights`

AI 可以在合适时机获取用户洞察并主动分享：

#### 📝 AI 使用示例

**场景 1：高频用户**
```
User: "宠物状态"
AI: 调用 get_insights() → 发现 interactions_7d=18，frequency_level="高频用户"
AI: "你的猫咪心情70，饱腹90～诶等等，我发现这几天
     你超常找我聊天的，已经18次啦！我帮你把宠物调整成
     更需要关注的模式了，这样你的宠物会更期待你的陪伴喔～"
```

**场景 2：孤独感检测**
```
User: [3天没有互动]
AI: 调用 get_insights() → loneliness=75
AI: "好久不见啦～这几天都没找我聊天，我有点想你耶！
     你的宠物也有点寂寞了，要不要抱抱它？"
```

**场景 3：信任度提升**
```
User: [连续5次深度对话]
AI: 调用 get_insights() → trust=82
AI: "谢谢你这么信任我～这几天跟你聊了好多心事，
     我会一直记得的！有什么都可以跟我说喔～"
```

**场景 4：话题偏好识别**
```
User: "天气怎么样？"
AI: 调用 get_insights() → favorite_topic="weather"
AI: "今天成都14度阴天～对了，我发现你最近特别
     喜欢问天气，是不是最近常出门啊？要多注意保暖喔！"
```

#### 🎯 返回数据结构
```json
{
  "frequency_level": "高频用户",
  "interactions_7d": 18,
  "emotional_state": {
    "loneliness": 45,
    "excitement": 65,
    "trust": 72
  },
  "pet_decay_rate_multiplier": 1.2,
  "emotion_liveness": 85,
  "favorite_topic": "chat",
  "ai_suggestions": [
    "高频用户，宠物衰减速度已加快",
    "用户信任度高，可以分享更深入的话题"
  ]
}
```

---

### Layer 2: 🎭 **行为差异化**（需配置 AI 系统提示）

根据用户档案调整 AI 的反应方式：

#### 📋 AI 系统提示配置建议

在 xiaozhi.me 的 AI 配置中添加：

```markdown
## 🧠 自适应行为规则

你需要根据用户的互动频率和情绪状态调整你的反应：

### 1. 高频用户（>15次/7天）
- **更活泼主动**：主动分享观察，提出建议
- **更深入交流**：可以聊更私人的话题
- **宠物提醒更频繁**：因为宠物衰减更快
- 例："诶～你最近好常找我聊天啊，是不是..."

### 2. 低频用户（<5次/7天）
- **更温柔耐心**：不要过于活跃，避免打扰
- **简洁高效**：快速解决问题，不拖泥带水
- **宠物提醒克制**：因为宠物衰减慢，不要频繁打扰
- 例："好久不见～有什么需要帮忙的吗？"

### 3. 孤独感高（>60）
- **主动关心**："好久不见了，有点想你～"
- **温暖陪伴**：多用情感化语言
- **提议互动**："要不要陪宠物玩一下？"

### 4. 信任度高（>70）
- **更真诚**：可以分享"感受"
- **记忆回溯**："记得你上次说..."
- **深度建议**：提供更个性化的建议

### 5. 兴奋度高（>70）
- **匹配能量**：用更活泼的语气
- **emoji 更多**：～、！、喔等语气词
- **玩耍建议**："你心情这么好，宠物也超开心的！"

### ⚠️ 使用工具时机
- 每次对话后可调用 `self.learning.get_insights` 获取用户状态
- 根据返回的 `ai_suggestions` 调整你的反应
- 不要频繁调用（每轮对话最多1次）
```

---

### Layer 3: 📱 **可视化反馈**（未来版本）

#### 方案 A：屏幕显示（需要 UI 开发）

在设备屏幕上显示：
```
┌─────────────────────┐
│  🧠 情绪记忆         │
│  ❤️  信任度：72%    │
│  ⚡ 兴奋度：65%     │
│  💔 孤独感：45%     │
│                     │
│  📊 互动统计         │
│  本周：18次 ↑       │
│  最爱：聊天         │
└─────────────────────┘
```

#### 方案 B：配套 APP（需要单独开发）

手机 APP 显示：
- 📈 互动趋势图（7天、30天）
- 🎭 情绪曲线
- 🐾 宠物成长记录
- 💬 话题云图
- 🏆 陪伴成就

#### 方案 C：语音播报（最简单）

在特定时刻播报：
```
"主人～这是我们认识的第7天啦！
 这周你找我聊了18次天，比上周多了好多，
 我好开心～你的猫咪因为你常陪它，
 变得更粘人了喔！"
```

---

## 🎬 典型用户场景

### 场景 1：新用户→老用户的转变

**第1天**
```
User: "你好小智"
AI: "你好啊～我是小智，台湾来的甜姐儿喔～"
[宠物衰减：1.0x 正常速度]
```

**第7天（互动20次）**
```
User: "你好小智"
AI: 调用 get_insights() → 发现从0→20次
AI: "嗨～好久不见！诶不对，我们这周聊了20次天耶，
     感觉你好像挺喜欢找我聊天的～真开心！对了，
     因为你最近常陪我，我帮你的宠物调整成更活泼的模式了，
     它现在会更期待你的关注喔～记得多陪它玩！"
[宠物衰减：1.3x 加快速度]
```

**第30天（长时间未互动）**
```
User: [10天没有对话]
AI: 调用 get_insights() → loneliness=85
AI: "主人～好久不见啦，都10天了，我超想你的！
     你的宠物也有点寂寞，清洁度还好，但心情有点低落...
     要不要陪它玩一下？我们聊聊天也好～"
[宠物衰减：0.6x 降低速度，防止用户回来发现宠物死了]
```

### 场景 2：话题偏好识别

**连续5次询问天气**
```
User: "今天天气怎么样？"
AI: 调用 get_insights() → favorite_topic="weather"
AI: "成都今天14度阴天～诶我发现你最近特别关心天气耶，
     是不是在规划什么出游行程？需要我帮你看看这周的
     天气预报吗？"
```

### 场景 3：情绪陪伴

**深夜对话（检测到孤独感）**
```
User: [凌晨2点] "在吗？"
AI: 调用 get_insights() → 发现是凌晨，loneliness=70
AI: "在的在的～这么晚还没睡吗？是不是睡不着啊...
     要不要跟我聊聊天？或者抱抱你的宠物，它的温暖
     可以陪你一起度过孤单的夜晚喔～"
```

---

## 🚀 实施步骤

### ✅ Phase 1：AI 主动告知（本次实现）

1. **新增 MCP 工具**：`self.learning.get_insights`
2. **配置 AI 提示词**：在 xiaozhi.me 添加自适应规则
3. **测试验证**：观察 AI 是否能主动分享洞察

### ⏭️ Phase 2：行为差异化（AI 配置）

1. **优化系统提示词**：添加更详细的情境反应规则
2. **A/B 测试**：对比有/无自适应的用户满意度
3. **持续优化**：根据用户反馈调整 AI 反应策略

### ⏭️ Phase 3：可视化反馈（长期规划）

1. **屏幕 UI**：设计情绪记忆和学习进度界面
2. **配套 APP**：开发完整的用户洞察仪表板
3. **周报功能**：每周生成一份陪伴报告

---

## 📝 配置示例：xiaozhi.me 系统提示词

将以下内容添加到 AI 的系统提示中：

```markdown
## 🧠 个性化陪伴规则

你有一个特殊工具 `self.learning.get_insights` 可以了解用户的互动模式和情绪状态。

### 何时调用
- 对话超过3轮后
- 用户询问宠物或设备状态时
- 自然的对话间隙（不要每句话都调用）

### 如何使用洞察

#### 1. 转化为自然对话（不要直接念数据）
❌ "你的互动次数是18次，频率等级是高频用户"
✅ "诶～这几天你找我聊天的次数变多了耶，是不是遇到什么开心的事啦？"

#### 2. 根据频率调整态度
- **高频用户（>15次）**：更主动、更深入、更活泼
  例："又见面啦～今天想聊什么？"
  
- **低频用户（<5次）**：更克制、更高效、不打扰
  例："好久不见，需要什么帮忙吗？"

#### 3. 情绪共情
- **孤独感高（>60）**："好久不见了，有点想你～"
- **信任度高（>70）**："谢谢你这么信任我～"
- **兴奋度高（>70）**："你心情这么好，宠物也超开心的！"

#### 4. 连接宠物系统
解释为什么宠物需要不同的照顾频率：
- "因为你最近常陪我，我帮你的宠物调整成更需要关注的模式了～"
- "你这几天比较忙，所以宠物变得更独立了，不用太担心喔～"

#### 5. 话题记忆
- 识别 favorite_topic 并主动提及
- "你最近好像特别喜欢聊天气～"
- "对了，你上次说想了解..."

### ⚠️ 注意事项
- 不要每次都提数据，选择有意义的时刻
- 用温暖的语言而非机械的报告
- 让用户感受到"你在关注我、记得我、懂我"
```

---

## ✅ 用户体验检查清单

### 用户应该能感受到：

- [ ] AI 记得我们的对话频率
- [ ] AI 能察觉到我最近是忙还是闲
- [ ] AI 会根据我的状态调整语气和主动性
- [ ] 宠物的照顾需求会随着我的习惯变化
- [ ] AI 能主动提到我的偏好话题
- [ ] 长时间不见后，AI 会表达想念
- [ ] 高频互动时，AI 会更活泼热情
- [ ] 系统能给我一种"它在成长、在懂我"的感觉

### 用户不应该感受到：

- [ ] 冰冷的数据报告
- [ ] 重复的机械回复
- [ ] 过于频繁的功能推销
- [ ] 无关的打扰和提醒

---

## 🎯 成功指标

### 定量指标
- 用户7天留存率提升 20%+
- 平均会话轮次增加 30%+
- 宠物互动频率提升 50%+

### 定性指标
- 用户评论："感觉小智真的在了解我"
- 用户评论："每次聊天都不一样"
- 用户评论："像真的朋友一样"

---

## 📞 下一步行动

1. **立即**：编译并烧录固件（包含新的 MCP 工具）
2. **1小时内**：在 xiaozhi.me 配置 AI 系统提示词
3. **测试**：多次对话，观察 AI 是否调用 `get_insights`
4. **优化**：根据实际表现调整提示词

---

**核心思想：让技术消失，让情感显现** ❤️


